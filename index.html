<!DOCTYPE html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--link rel="stylesheet" type="text/css" href="tally.css" media="screen" /-->
    <title>Hitung Skor</title>
    <style>
        body {
            background: rgb(22, 116, 0);
            background: linear-gradient(180deg, rgba(22, 116, 0, 1) 0%, rgb(54, 139, 55) 60%, rgb(17, 104, 28) 100%);
        }
        
        table,
        th,
        td {
            border: 2px solid black;
            border-collapse: collapse;
            padding: 1rem;
        }
        
        table {
            margin: auto;
            border-radius: 6px;
        }
        
        th {
            background-color: rgb(12, 68, 3);
            color: white;
        }
        
        td {
            text-align: center;
        }
        
        .cont {
            display: flex;
            align-items: flex-start;
            justify-content: center;
            border: 3px solid #000;
            border-radius: 10px;
            background: linear-gradient(90deg, #bdb76b 0%, #cdca8f 40%, #dbd68c 80%);
            max-width: auto;
        }
        
        .containerless label {
            text-align: center;
            font-family: "Century Gothic";
            font-weight: bolder;
            color: white;
        }
        
        .container {
            max-width: 100px;
            max-height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 1rem;
        }
        
        .container1 {
            min-width: 50px;
            min-height: 50px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 1rem;
        }
        
        .container2 {
            max-width: 100px;
            max-height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 1rem;
        }
        
        .button {
            border: 2px solid #000;
            border-radius: 10px;
            background: rgb(89, 103, 228);
            color: white;
            padding: 16px 32px;
            text-align: center;
            font-family: "Century Gothic";
            font-weight: bolder;
        }
        
        .button:hover {
            background: linear-gradient(90deg, rgb(65, 78, 193) 0%, rgb(42, 14, 152) 60%, rgb(65, 78, 193) 100%);
        }
        
        h1 {
            font-family: "Century Gothic";
            font-size: large;
            font-weight: bold;
            color: azure;
            text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
        }
        
        h2 {
            font-family: "Century Gothic";
            font-size: medium;
            font-weight: bold;
            color: azure;
            text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
        }
        
        tbody tr:nth-child(odd) {
            background: rgb(157, 188, 255);
        }
        
        tbody tr:nth-child(even) {
            background: rgb(255, 255, 255);
        }
    </style>
</head>

<body>
    <div class="cont">
        <div class="container">
            <br>
            <br>
            <br>
            <img id="wcds" src="wcds.png" height="100px" width="100px">
        </div>
        <div class="container">
            <h1> </h1>
        </div>
        <div class="container1">
            <h1>
                RESIMEN MAHASISWA
            </h1>
            <h1>
                UNIVERSITAS INDONESIA
            </h1>
            <br>
            <h2>
                PAPAN SKOR
            </h2>
            <h2>
                PESERTA GIAT MENEMBAK
            </h2>
        </div>
        <div class="container">
            <h1> </h1>
        </div>
        <div class="container2">
            <br>
            <br>
            <br>
            <img id="wiramakara" src="wira makara.png" height="100px" width="100px">
        </div>
    </div>
    <br>
    <br>
    <div class="cont">
        <br>
        <font face="Century Gothic">
            <center>
                <h2>SKOR TERKINI</h2>
            </center><br>
            <table>
                <thead>
                    <tr>
                        <th>
                            Nama
                        </th>
                        <th>
                            Kaleng
                        </th>
                        <th>
                            Target Senapan
                        </th>
                        <th>
                            Target Pistol
                        </th>
                        <th>
                            Reaksi
                        </th>
                        <th>
                            Metsir
                        </th>
                        <th>
                            Status
                        </th>
                    </tr>
                </thead>
                <tbody id="table">
                </tbody>
            </table>
            <br>
            <center>
                <h2>-2022-</h2>
            </center>
        </font>
    </div>
    <br>
    <br>
    <center>
        <div class="containerless">
            <br>
            <label for="editnama">Edit Nilai:</label>
        </div>
        <br>
        <input type="text" id="editnama" name="editsiswa" placeholder="Isi nama peserta..">
        <input type="number" min="0" id="editnilai" name="editnilai" placeholder="Isi nilai peserta..">
        <select name="skill" id="skill">
            <option value="kaleng">Kaleng</option>
            <option value="senapan">Senapan</option>
            <option value="pistol">Pistol</option>
            <option value="reaksi">Reaksi</option>
            <option value="metsir">Metsir</option>
        </select>
        <button class="button button1" onclick="setPoin()">Edit</button>
        <br>
        <div class="containerless">
            <br>
            <label for="peserta">Peserta Baru:</label>
        </div>
        <br>
        <input type="text" id="peserta" name="siswa" placeholder="Isi nama peserta..">
        <button class="button button3" onclick="addRow()">Tambah Nama</button>
        <br>
        <button class="button button2" onclick="saveProgress()"></button>
    </center>

    <script>
        var jumlahPeserta = 0;
        const namaPeserta = document.getElementById('peserta');
        const namaPeserta2 = document.getElementById('editnama');
        const poin = document.getElementById('editnilai');
        const skill = document.getElementById('skill')

        let kumpulanSiswa = [];

        function createData() {
            let siswa = [namaPeserta.value, 0, 0, 0, 0, 0, "Belum Lulus"]
            kumpulanSiswa.push(siswa);

        }

        function getVal() {
            const val = document.getElementById('input').value;
            console.log(val);
        }

        function setStatus(p) {
            var total = 0;
            for (let i = 1; i < 6; i++) {
                if (kumpulanSiswa[p][i] >= 70) {
                    total++;
                }
            }
            return total;
        }

        function setPoin() {
            if (checkIterate(namaPeserta2.value) == 0) {
                alert("Nama peserta tidak ada.");
            } else {
                if (poin.value == "" || poin.value < 0) {
                    alert("Nilai tidak valid.");
                } else {
                    if (skill.value == 'kaleng') {
                        for (let i = 0; i < jumlahPeserta; i++) {
                            if (namaPeserta2.value == kumpulanSiswa[i][0]) {
                                kumpulanSiswa[i][1] = poin.value;
                                document.getElementById('table').rows.item(i).cells.item(1).innerHTML = poin.value;
                                if (setStatus(i) == 5) {
                                    kumpulanSiswa[i][6] = "Lulus";
                                    document.getElementById('table').rows.item(i).cells.item(6).innerHTML = "Lulus";
                                }
                            };
                        }
                    } else if (skill.value == 'senapan') {
                        for (let i = 0; i < jumlahPeserta; i++) {
                            if (namaPeserta2.value == kumpulanSiswa[i][0]) {
                                kumpulanSiswa[i][2] = poin.value;
                                document.getElementById('table').rows.item(i).cells.item(2).innerHTML = poin.value;
                                if (setStatus(i) == 5) {
                                    kumpulanSiswa[i][6] = "Lulus";
                                    document.getElementById('table').rows.item(i).cells.item(6).innerHTML = "Lulus";
                                }
                            };
                        }
                    } else if (skill.value == 'pistol') {
                        for (let i = 0; i < jumlahPeserta; i++) {
                            if (namaPeserta2.value == kumpulanSiswa[i][0]) {
                                kumpulanSiswa[i][3] = poin.value;
                                document.getElementById('table').rows.item(i).cells.item(3).innerHTML = poin.value;
                                if (setStatus(i) == 5) {
                                    kumpulanSiswa[i][6] = "Lulus";
                                    document.getElementById('table').rows.item(i).cells.item(6).innerHTML = "Lulus";
                                }
                            };
                        }
                    } else if (skill.value == 'reaksi') {
                        for (let i = 0; i < jumlahPeserta; i++) {
                            if (namaPeserta2.value == kumpulanSiswa[i][0]) {
                                kumpulanSiswa[i][4] = poin.value;
                                document.getElementById('table').rows.item(i).cells.item(4).innerHTML = poin.value;
                                if (setStatus(i) == 5) {
                                    kumpulanSiswa[i][6] = "Lulus";
                                    document.getElementById('table').rows.item(i).cells.item(6).innerHTML = "Lulus";
                                }
                            };
                        }
                    } else if (skill.value == 'metsir') {
                        for (let i = 0; i < jumlahPeserta; i++) {
                            if (namaPeserta2.value == kumpulanSiswa[i][0]) {
                                kumpulanSiswa[i][5] = poin.value;
                                document.getElementById('table').rows.item(i).cells.item(5).innerHTML = poin.value;
                                if (setStatus(i) == 5) {
                                    kumpulanSiswa[i][6] = "Lulus";
                                    document.getElementById('table').rows.item(i).cells.item(6).innerHTML = "Lulus";
                                }
                            };
                        }
                    }
                    localStorage.setItem("kumpulanSiswa", JSON.stringify(kumpulanSiswa));
                }

            }
        }

        function loadProgress() {
            let lastSave = localStorage.getItem("kumpulanSiswa");
            if (lastSave) {
                lastSave = JSON.parse(lastSave);
                for (let i = 0; i < kumpulanSiswa.length; i++) {
                    var row = document.createElement("tr");
                    for (let i = 0; i < 7; i++) {
                        var data = document.createElement("td");
                        row.appendChild(data);
                        data.innerHTML = kumpulanSiswa[jumlahPeserta][i];
                    }
                }
                var element = document.getElementById("table");
                element.appendChild(row);
            }
        }

        function checkIterate(isi) {
            for (let i = 0; i < jumlahPeserta; i++) {
                if (isi == kumpulanSiswa[i][0]) {
                    return 1;
                };
            }
            return 0;
        }

        function addRow() {
            if (namaPeserta.value == "") {
                alert("Nama Peserta belum diisi.")
            } else if (checkIterate(namaPeserta.value) == 1) {
                alert("Nama peserta sudah ada.")
            } else {
                createData();
                var row = document.createElement("tr");
                for (let i = 0; i < 7; i++) {
                    var data = document.createElement("td");
                    row.appendChild(data);
                    data.innerHTML = kumpulanSiswa[jumlahPeserta][i];
                }
                jumlahPeserta++;

                var element = document.getElementById("table");
                element.appendChild(row);

                localStorage.setItem("kumpulanSiswa", arr);
            }
        }

        window.onload = function() {
            loadProgress();
        }
    </script>

</body>

</html>
